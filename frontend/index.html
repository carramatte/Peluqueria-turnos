<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Dashboard premium para gestión de turnos y clientes en barberías.">
  <title>Dashboard | Barbería (Tesla Clean Edition)</title>

  <!-- Preconnect to fonts & load Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="styles.css">

  <!-- SVG Icons System (Feather & Tabler inspired) -->
  <svg style="display: none;">

    <!-- System & Nav Icons -->
    <symbol id="icon-grid" viewBox="0 0 24 24">
      <rect x="3" y="3" width="7" height="7"></rect>
      <rect x="14" y="3" width="7" height="7"></rect>
      <rect x="14" y="14" width="7" height="7"></rect>
      <rect x="3" y="14" width="7" height="7"></rect>
    </symbol>
    <symbol id="icon-calendar" viewBox="0 0 24 24">
      <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
      <line x1="16" y1="2" x2="16" y2="6"></line>
      <line x1="8" y1="2" x2="8" y2="6"></line>
      <line x1="3" y1="10" x2="21" y2="10"></line>
    </symbol>
    <symbol id="icon-users" viewBox="0 0 24 24">
      <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
      <circle cx="9" cy="7" r="4"></circle>
      <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
      <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
    </symbol>
    <symbol id="icon-message" viewBox="0 0 24 24">
      <path
        d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z">
      </path>
    </symbol>
    <symbol id="icon-settings" viewBox="0 0 24 24">
      <circle cx="12" cy="12" r="3"></circle>
      <path
        d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
      </path>
    </symbol>
    <symbol id="icon-bell" viewBox="0 0 24 24">
      <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
      <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
    </symbol>
    <symbol id="icon-refresh" viewBox="0 0 24 24">
      <polyline points="23 4 23 10 17 10"></polyline>
      <polyline points="1 20 1 14 7 14"></polyline>
      <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
    </symbol>
    <symbol id="icon-plus" viewBox="0 0 24 24">
      <line x1="12" y1="5" x2="12" y2="19"></line>
      <line x1="5" y1="12" x2="19" y2="12"></line>
    </symbol>
    <symbol id="icon-clock" viewBox="0 0 24 24">
      <circle cx="12" cy="12" r="10"></circle>
      <polyline points="12 6 12 12 16 14"></polyline>
    </symbol>
    <symbol id="icon-check-circle" viewBox="0 0 24 24">
      <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
      <polyline points="22 4 12 14.01 9 11.01"></polyline>
    </symbol>
    <symbol id="icon-x-circle" viewBox="0 0 24 24">
      <circle cx="12" cy="12" r="10"></circle>
      <line x1="15" y1="9" x2="9" y2="15"></line>
      <line x1="9" y1="9" x2="15" y2="15"></line>
    </symbol>
    <symbol id="icon-menu" viewBox="0 0 24 24">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </symbol>
    <symbol id="icon-filter" viewBox="0 0 24 24">
      <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
    </symbol>
    <symbol id="icon-search" viewBox="0 0 24 24">
      <circle cx="11" cy="11" r="8"></circle>
      <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
    </symbol>
    <symbol id="icon-edit" viewBox="0 0 24 24">
      <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
      <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
    </symbol>
    <symbol id="icon-trash" viewBox="0 0 24 24">
      <polyline points="3 6 5 6 21 6"></polyline>
      <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
      <line x1="10" y1="11" x2="10" y2="17"></line>
      <line x1="14" y1="11" x2="14" y2="17"></line>
    </symbol>
    <symbol id="icon-scissors" viewBox="0 0 24 24">
      <circle cx="6" cy="6" r="3"></circle>
      <circle cx="6" cy="18" r="3"></circle>
      <line x1="20" y1="4" x2="8.12" y2="15.88"></line>
      <line x1="14.47" y1="14.48" x2="20" y2="20"></line>
      <line x1="8.12" y1="8.12" x2="12" y2="12"></line>
    </symbol>
    <symbol id="icon-scissors-alt" viewBox="0 0 24 24">
      <circle cx="6" cy="6" r="3"></circle>
      <circle cx="6" cy="18" r="3"></circle>
      <line x1="20" y1="4" x2="8.12" y2="15.88"></line>
      <line x1="14.47" y1="14.48" x2="20" y2="20"></line>
      <line x1="8.12" y1="8.12" x2="12" y2="12"></line>
    </symbol>

    <!-- Channels (Filled paths for exact brand shapes) -->
    <symbol id="icon-whatsapp" viewBox="0 0 24 24">
      <path
        d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51a12.8 12.8 0 0 0-.57-.01c-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 0 1-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 0 1-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 0 1 2.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0 0 12.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 0 0 5.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 0 0-3.48-8.413z" />
    </symbol>
    <symbol id="icon-instagram" viewBox="0 0 24 24">
      <path
        d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.20 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 1 0 0 12.324 6.162 6.162 0 0 0 0-12.324zM12 16a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm6.406-11.845a1.44 1.44 0 1 0 0 2.881 1.44 1.44 0 0 0 0-2.881z" />
    </symbol>
    <symbol id="icon-facebook" viewBox="0 0 24 24">
      <path
        d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.469h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.469h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" />
    </symbol>

    <!-- File specific -->
    <symbol id="icon-empty-state" viewBox="0 0 24 24">
      <rect x="4" y="4" width="16" height="16" rx="2" ry="2"></rect>
      <rect x="9" y="9" width="6" height="6"></rect>
      <line x1="9" y1="1" x2="9" y2="4"></line>
      <line x1="15" y1="1" x2="15" y2="4"></line>
      <line x1="9" y1="20" x2="9" y2="23"></line>
      <line x1="15" y1="20" x2="15" y2="23"></line>
      <line x1="20" y1="9" x2="23" y2="9"></line>
      <line x1="20" y1="14" x2="23" y2="14"></line>
      <line x1="1" y1="9" x2="4" y2="9"></line>
      <line x1="1" y1="14" x2="4" y2="14"></line>
    </symbol>
  </svg>
</head>

<body>

  <!-- ── Sidebar ── -->
  <aside class="sidebar" id="sidebar">
    <!-- Brand -->
    <div class="sidebar-brand">
      <img src="assets/premium-barber-logo.jpg" alt="Barber Logo" class="brand-logo" id="main-logo"
        onerror="this.src='https://i.imgur.com/rL7I1V9.jpg'">
    </div>

    <nav class="sidebar-nav">
      <button class="nav-btn active" data-view="dashboard" id="nav-dashboard">
        <span class="nav-icon"><svg>
            <use href="#icon-grid"></use>
          </svg></span> Dashboard
      </button>
      <button class="nav-btn" data-view="appointments" id="nav-appointments">
        <span class="nav-icon"><svg>
            <use href="#icon-calendar"></use>
          </svg></span> Turnos
      </button>
      <button class="nav-btn" data-view="clients" id="nav-clients">
        <span class="nav-icon"><svg>
            <use href="#icon-users"></use>
          </svg></span> Clientes
      </button>
      <button class="nav-btn" data-view="inquiries" id="nav-inquiries">
        <span class="nav-icon"><svg>
            <use href="#icon-message"></use>
          </svg></span> Consultas
        <span class="nav-badge" id="nav-badge-inquiries" style="display: none;">0</span>
      </button>
      <button class="nav-btn" data-view="availability" id="nav-availability">
        <span class="nav-icon"><svg>
            <use href="#icon-clock"></use>
          </svg></span> Disponibilidad
      </button>
      <button class="nav-btn" data-view="settings" id="nav-settings" style="margin-top: auto;">
        <span class="nav-icon"><svg>
            <use href="#icon-settings"></use>
          </svg></span> Configuración
      </button>
      <!-- Footer -->
      <div class="sidebar-footer">
        <div class="status-badge">
          <span class="status-dot"></span>
          Sistema Activo
        </div>
      </div>
  </aside>

  <!-- ── Main Content ── -->
  <main class="main-content">

    <!-- ── Header ── -->
    <header class="top-header">
      <button class="menu-toggle" id="menu-toggle">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="24" height="24">
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>

      <div class="header-info">
        <h2 class="header-title" id="page-title">Dashboard</h2>
        <span class="header-date" id="header-date">Cargando fecha...</span>
      </div>

      <div class="header-actions">
        <!-- New Turno Button (Global) -->
        <button class="btn btn-primary" id="btn-global-new" data-view-target="new-appointment">
          <svg>
            <use href="#icon-plus"></use>
          </svg> Nuevo Turno
        </button>

        <!-- Notification Bell -->
        <button class="notification-bell" id="notification-toggle">
          <svg>
            <use href="#icon-bell"></use>
          </svg>
          <span class="notification-count" id="notification-badge" data-count="0"></span>
        </button>

        <!-- Notification Dropdown -->
        <div class="notification-dropdown" id="notification-dropdown">
          <div class="notification-dropdown-header">
            <span>Notificaciones</span>
            <button class="btn btn-sm btn-outline" id="btn-clear-notifications"
              style="border: none; padding: 0;">Limpiar</button>
          </div>
          <div class="notification-list" id="notification-list">
            <div class="notification-empty">No hay notificaciones recientes</div>
          </div>
        </div>
      </div>
    </header>

    <!-- ── VIEW 1: Dashboard ── -->
    <section class="view active" id="view-dashboard">
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon gold"><svg>
              <use href="#icon-calendar"></use>
            </svg></div>
          <div class="stat-info">
            <span class="stat-value" id="stat-today-count">-</span>
            <span class="stat-label">Turnos Hoy</span>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon green"><svg>
              <use href="#icon-check-circle"></use>
            </svg></div>
          <div class="stat-info">
            <span class="stat-value" id="stat-confirmed-count">-</span>
            <span class="stat-label">Confirmados</span>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon blue"><svg>
              <use href="#icon-clock"></use>
            </svg></div>
          <div class="stat-info">
            <span class="stat-value" id="stat-available-count">-</span>
            <span class="stat-label">Slots Libres</span>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon orange"><svg>
              <use href="#icon-message"></use>
            </svg></div>
          <div class="stat-info">
            <span class="stat-value" id="stat-pending-inquiries-count">-</span>
            <span class="stat-label">Pendientes</span>
          </div>
        </div>
      </div>

      <div class="dashboard-grid">
        <!-- Próximos Turnos (Left - 60%) -->
        <div class="card">
          <div class="card-header">
            <h3><svg>
                <use href="#icon-clock"></use>
              </svg> Próximos Turnos</h3>
            <button class="btn btn-sm btn-outline" id="btn-refresh-dashboard">
              <svg>
                <use href="#icon-refresh"></use>
              </svg>
            </button>
          </div>
          <div class="card-body" id="upcoming-list">
            <div class="loading-spinner"></div>
          </div>
        </div>

        <!-- Canales de Comunicación (Right - 40%) -->
        <div class="card">
          <div class="card-header">
            <h3><svg>
                <use href="#icon-message"></use>
              </svg> Canales Integrados</h3>
          </div>
          <div class="card-body">
            <div class="channels-list">
              <div class="channel-item">
                <div class="channel-icon whatsapp"><svg>
                    <use href="#icon-whatsapp"></use>
                  </svg></div>
                <div class="channel-name">WhatsApp</div>
                <div class="channel-count" id="dash-wa-count">-</div>
                <div class="channel-status active">Conectado</div>
              </div>
              <div class="channel-item">
                <div class="channel-icon instagram"><svg>
                    <use href="#icon-instagram"></use>
                  </svg></div>
                <div class="channel-name">Instagram</div>
                <div class="channel-count" id="dash-ig-count">-</div>
                <div class="channel-status pending">Setup</div>
              </div>
              <div class="channel-item">
                <div class="channel-icon facebook"><svg>
                    <use href="#icon-facebook"></use>
                  </svg></div>
                <div class="channel-name">Facebook</div>
                <div class="channel-count" id="dash-fb-count">-</div>
                <div class="channel-status pending">Setup</div>
              </div>
            </div>

            <div style="margin-top: 20px;">
              <button class="btn btn-outline" style="width: 100%; justify-content: center;"
                onclick="document.getElementById('nav-inquiries').click()">
                Ver Bandeja de Entrada
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ── VIEW 2: Turnos (Appointments) ── -->
    <section class="view" id="view-appointments">
      <div class="toolbar">
        <div class="toolbar-filters">
          <label class="filter-label">
            Fecha:
            <input type="date" id="filter-date" class="input-field">
          </label>
          <label class="filter-label">
            Estado:
            <select id="filter-status" class="input-field">
              <option value="">Todos los estados</option>
              <option value="confirmed">Confirmados</option>
              <option value="completed">Completados</option>
              <option value="cancelled">Cancelados</option>
            </select>
          </label>
          <label class="filter-label" style="justify-content: flex-end;">
            <button class="btn btn-secondary" id="btn-filter-apply"
              style="height: 38px; border: 1px solid var(--border-color); background: var(--bg-card); color: var(--text-primary);">
              <svg>
                <use href="#icon-filter"></use>
              </svg> Filtrar
            </button>
          </label>
        </div>

        <div class="toolbar-right">
          <div class="view-toggle">
            <button class="view-toggle-btn active" data-mode="list">Lista</button>
            <button class="view-toggle-btn" data-mode="calendar">Calendario</button>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-body" style="padding: 0;">
          <div class="table-wrapper">
            <table class="data-table" id="appointments-table">
              <thead>
                <tr>
                  <th>Hora</th>
                  <th>Cliente</th>
                  <th>Servicio</th>
                  <th>Contacto</th>
                  <th>Canal</th>
                  <th>Estado</th>
                  <th style="text-align: right;">Acciones</th>
                </tr>
              </thead>
              <tbody id="appointments-tbody">
                <tr>
                  <td colspan="7">
                    <div class="loading-spinner"></div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- ── VIEW 3: Crear Nuevo Turno ── -->
    <section class="view" id="view-new-appointment">
      <div class="toolbar" style="margin-bottom: 24px;">
        <button class="btn btn-outline" onclick="document.getElementById('nav-appointments').click()">
          &larr; Volver a Turnos
        </button>
      </div>

      <div class="form-grid">
        <div class="card">
          <div class="card-header">
            <h3><svg>
                <use href="#icon-plus"></use>
              </svg> Detalles del Turno</h3>
          </div>
          <div class="card-body">
            <form id="appointment-form">
              <div class="form-group">
                <label for="input-name">Nombre del Cliente</label>
                <input type="text" id="input-name" class="input-field" placeholder="Ej: Marcos Silva" required>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="input-phone">Teléfono Móvil</label>
                  <input type="tel" id="input-phone" class="input-field" placeholder="+54 9 11 1234-5678" required>
                </div>
                <div class="form-group">
                  <label for="input-channel">Origen / Canal</label>
                  <select id="input-channel" class="input-field">
                    <option value="whatsapp">WhatsApp</option>
                    <option value="instagram">Instagram</option>
                    <option value="facebook">Facebook</option>
                    <option value="presencial">Presencial / Teléfono</option>
                  </select>
                </div>
              </div>

              <div class="form-group">
                <label for="input-service">Servicio Solicitado</label>
                <select id="input-service" class="input-field" required>
                  <option value="">Selecciona un servicio...</option>
                </select>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="input-date">Fecha del Turno</label>
                  <input type="date" id="input-date" class="input-field" required>
                </div>
                <div class="form-group">
                  <label for="input-time">Hora</label>
                  <select id="input-time" class="input-field" required>
                    <option value="">Elige una fecha primero</option>
                  </select>
                </div>
              </div>

              <div class="form-actions">
                <button type="button" class="btn btn-outline"
                  onclick="document.getElementById('appointment-form').reset()">Limpiar</button>
                <button type="submit" class="btn btn-primary btn-glow" id="btn-submit-appointment">
                  Confirmar Reserva
                </button>
              </div>
            </form>
          </div>
        </div>

        <!-- Live Preview / Disponibilidad Inline -->
        <div class="card">
          <div class="card-header">
            <h3><svg>
                <use href="#icon-clock"></use>
              </svg> Horarios Libres</h3>
          </div>
          <div class="card-body">
            <div id="slots-preview" class="availability-grid">
              <div class="empty-state" style="grid-column: 1 / -1; padding: 40px 10px;">
                <svg>
                  <use href="#icon-calendar"></use>
                </svg>
                Selecciona una fecha en el formulario para visualizar los horarios disponibles.
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ── VIEW 4: Clientes (Nuevo) ── -->
    <section class="view" id="view-clients">
      <div class="clients-stats">
        <div class="stat-card">
          <div class="stat-icon gold"><svg>
              <use href="#icon-users"></use>
            </svg></div>
          <div class="stat-info">
            <span class="stat-value" id="stat-clients-total">0</span>
            <span class="stat-label">Total Clientes</span>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon green"><svg>
              <use href="#icon-plus"></use>
            </svg></div>
          <div class="stat-info">
            <span class="stat-value" id="stat-clients-new">0</span>
            <span class="stat-label">Nuevos (Mes)</span>
          </div>
        </div>
      </div>

      <div class="toolbar">
        <label class="filter-label" style="flex: 1; max-width: 300px;">
          Buscar Cliente:
          <div style="position: relative;">
            <input type="text" id="search-client" class="input-field" placeholder="Nombre o teléfono..."
              style="padding-left: 32px;">
            <svg
              style="position: absolute; left: 10px; top: 10px; width: 14px; height: 14px; stroke: var(--text-muted); fill: none;">
              <use href="#icon-search"></use>
            </svg>
          </div>
        </label>
      </div>

      <div class="card">
        <div class="card-body" style="padding: 0; position:relative;">
          <div id="clients-loading" class="loading-overlay" style="display:none;">
            <div class="loading-spinner"></div>
          </div>
          <table class="data-table clients-table">
            <thead>
              <tr>
                <th>Nombre y Canal</th>
                <th style="width: 15%; text-align:right;">Contacto</th>
                <th style="width: 15%; text-align:right;">Frecuencia</th>
                <th style="width: 15%; text-align:right;">Última Visita</th>
                <th style="width: 100px; text-align:right;">Historial</th>
              </tr>
            </thead>
            <tbody id="clients-tbody">
              <!-- Filled by JS -->
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- ── VIEW 5: Consultas (Nuevo) ── -->
    <section class="view" id="view-inquiries">
      <div class="inquiries-stats">
        <div class="inquiry-stat-card whatsapp">
          <div class="inquiry-stat-icon whatsapp"><svg>
              <use href="#icon-whatsapp"></use>
            </svg></div>
          <div class="inquiry-stat-info">
            <span class="stat-value" id="inq-wa-count">0</span>
            <span class="stat-label">WhatsApp</span>
          </div>
        </div>
        <div class="inquiry-stat-card instagram">
          <div class="inquiry-stat-icon instagram"><svg>
              <use href="#icon-instagram"></use>
            </svg></div>
          <div class="inquiry-stat-info">
            <span class="stat-value" id="inq-ig-count">0</span>
            <span class="stat-label">Instagram Direct</span>
          </div>
        </div>
        <div class="inquiry-stat-card facebook">
          <div class="inquiry-stat-icon facebook"><svg>
              <use href="#icon-facebook"></use>
            </svg></div>
          <div class="inquiry-stat-info">
            <span class="stat-value" id="inq-fb-count">0</span>
            <span class="stat-label">Facebook Messenger</span>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h3><svg>
              <use href="#icon-message"></use>
            </svg> Bandeja de Entrada Unificada</h3>
          <div class="view-toggle">
            <button class="view-toggle-btn active" data-filter="all">Todos</button>
            <button class="view-toggle-btn" data-filter="unread">No leídos</button>
          </div>
        </div>
        <div class="card-body" style="padding: 0 20px;">
          <div id="inquiries-list">
            <!-- Mocked items, to be populated by JS -->
            <div class="empty-state">
              <svg>
                <use href="#icon-message"></use>
              </svg>
              <p>No hay consultas nuevas en este momento.</p>
              <p style="font-size: 0.75rem; margin-top: 8px;">Conecta n8n para recibir mensajes aquí.</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ── VIEW 6: Disponibilidad (Renovado) ── -->
    <section class="view" id="view-availability">
      <div class="toolbar" style="margin-bottom: 24px;">
        <label class="filter-label">
          Ver disponibilidad para:
          <input type="date" id="avail-date" class="input-field" style="width: 200px;">
        </label>
        <button class="btn btn-primary" id="btn-check-avail">Actualizar Mapa</button>
      </div>

      <div class="form-grid">
        <div class="card">
          <div class="card-header">
            <h3><svg>
                <use href="#icon-grid"></use>
              </svg> Mapa de Horarios</h3>
          </div>
          <div class="card-body">
            <div id="availability-grid" class="availability-grid">
              <div class="empty-state" style="grid-column: 1 / -1; padding: 30px;">
                Selecciona una fecha.
              </div>
            </div>

            <div class="availability-legend">
              <div class="legend-item">
                <div class="legend-dot green"></div> Libre
              </div>
              <div class="legend-item">
                <div class="legend-dot red"></div> Ocupado
              </div>
              <div class="legend-item">
                <div class="legend-dot yellow"></div> Próximo (< 15 min)</div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <h3><svg>
                  <use href="#icon-scissors"></use>
                </svg> Catálogo de Servicios</h3>
            </div>
            <div class="card-body">
              <div id="services-list" class="services-grid" style="grid-template-columns: 1fr;">
                <div class="loading-spinner"></div>
              </div>
            </div>
          </div>
        </div>
    </section>

    <!-- ── VIEW 7: Configuración (Nuevo) ── -->
    <section class="view" id="view-settings">
      <div class="card" style="margin-bottom: 20px;">
        <div class="card-header">
          <h3><svg>
              <use href="#icon-settings"></use>
            </svg> Configuración General del Negocio</h3>
          <button class="btn btn-sm btn-primary" id="btn-save-settings">Guardar Cambios</button>
        </div>
        <div class="card-body">
          <div class="settings-grid">

            <!-- Panel Izquierdo: Horarios -->
            <div class="settings-section">
              <h4 class="settings-section-title"><svg>
                  <use href="#icon-clock"></use>
                </svg> Horario Laboral</h4>
              <p style="font-size: 0.8rem; color: var(--text-muted); margin-bottom: 16px;">Define tus horas de apertura
                y cierre por defecto.</p>

              <div class="form-group">
                <label>Horario Estándar</label>
                <div class="time-range">
                  <input type="time" id="set-time-open" class="input-field" value="09:00">
                  <span class="separator">hasta</span>
                  <input type="time" id="set-time-close" class="input-field" value="19:00">
                </div>
              </div>

              <div class="form-group">
                <label>Duración estándar por slot (minutos)</label>
                <select id="set-slot-length" class="input-field" style="max-width: 150px;">
                  <option value="15">15 min</option>
                  <option value="30" selected>30 min</option>
                  <option value="45">45 min</option>
                  <option value="60">1 hora</option>
                </select>
              </div>

              <div class="form-group" style="margin-top: 24px;">
                <label>Días de Descanso (Cerrado)</label>
                <div class="checkbox-group">
                  <label class="checkbox-label"><input type="checkbox" value="1"> Lunes</label>
                  <label class="checkbox-label"><input type="checkbox" value="2"> Martes</label>
                  <label class="checkbox-label"><input type="checkbox" value="3"> Miércoles</label>
                  <label class="checkbox-label"><input type="checkbox" value="4"> Jueves</label>
                  <label class="checkbox-label"><input type="checkbox" value="5"> Viernes</label>
                  <label class="checkbox-label"><input type="checkbox" value="6"> Sábado</label>
                  <label class="checkbox-label checked"><input type="checkbox" value="0" checked> Domingo</label>
                </div>
              </div>
            </div>

            <!-- Panel Derecho: Servicios Rápido -->
            <div class="settings-section">
              <h4 class="settings-section-title"><svg>
                  <use href="#icon-scissors"></use>
                </svg> Gestión de Servicios</h4>
              <p style="font-size: 0.8rem; color: var(--text-muted); margin-bottom: 16px;">
                Carga o modifica los servicios que ofreces. <br>
                <i>(Nota: En esta versión beta, requiere reiniciar el servidor de DB)</i>
              </p>

              <div
                style="background: var(--bg-card-hover); padding: 16px; border-radius: var(--radius-sm); border: 1px dashed var(--border-color);">
                <div class="form-row" style="margin-bottom: 10px;">
                  <div class="form-group" style="margin-bottom: 0;">
                    <label>Nombre</label>
                    <input type="text" class="input-field" placeholder="Ej: Degradé" id="temp-svc-name">
                  </div>
                  <div class="form-group" style="margin-bottom: 0;">
                    <label>Precio ($)</label>
                    <input type="number" class="input-field" placeholder="0.00" id="temp-svc-price">
                  </div>
                </div>
                <button class="btn btn-sm btn-outline" style="width: 100%; justify-content: center;"><svg>
                    <use href="#icon-plus"></use>
                  </svg> Añadir Servicio (Próximamente)</button>
              </div>
            </div>

          </div>
        </div>
      </div>
    </section>

    <!-- ── Toast Notifications Container ── -->
    <div class="toast-container" id="toast-container"></div>
  </main>

  <!-- Script Principal -->
  <script src="app.js"></script>
</body>

</html>